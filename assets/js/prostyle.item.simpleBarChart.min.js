/*!
 * @license: MIT License - See https://github.com/GaryChamberlain/prostyle-item-simpleBarChart/LICENSE
 * @author: Gary Chamberlain, gary@pro.graphics.
 **/

var __extends=this.__extends||function(c,b){function m(){this.constructor=c}for(var k in b)b.hasOwnProperty(k)&&(c[k]=b[k]);m.prototype=b.prototype;c.prototype=new m},ProStyle;
(function(c){(function(b){(function(b){(function(b){var e=function(e){function d(a,t,d,c,g,b){e.call(this,a,t,d,g,c,b)}__extends(d,e);d.prototype.scrubValue=function(a){var d=[];if("number"===typeof a)return[[void 0,a]];"string"===typeof a?a.split(",").forEach(function(a){d.push([0,c.Util.convertToNumber(a.trim())])}):a instanceof Array&&a.forEach(function(a){a instanceof Array?d.push([0<a.length?c.Util.convertToNumber(a[0]):0,1<a.length?c.Util.convertToNumber(a[1]):0]):d.push([0,c.Util.convertToNumber(a)])});
return d};d.prototype.writeCssBucket=function(a,d,c,e,g){a=e.element.proCache||{};e.element.proCache=a;e=e.elementIndex;a=a.data=[0,0];g.length>e&&(g=g[e],0<g.length&&(a[0]=g[0]),1<g.length&&(a[1]=g[1]))};return d}(c.Models.Properties.Variables.VariableType);b.BarDataVariableType=e})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(c.Extensions||(c.Extensions={}))})(ProStyle||(ProStyle={}));
(function(c){(function(b){(function(b){(function(b){var e=c.Models.Properties,f=function(d){function a(){var a=[];a.push(new b.BarDataVariableType("values",["values"],"dummy",[],"",!0));d.call(this,"data",["data"],a)}__extends(a,d);a.prototype.createPropertyFromBoolean=function(a){return d.prototype.createPropertyFromBoolean.call(this,!1)};a.prototype.createProperty=function(a){var d=new e.Property(this);d.values.setValue(a);return d};a.prototype.createPropertyFromNumber=function(a){return this.createProperty(a)};
a.prototype.createPropertyFromString=function(a){return this.createProperty(a)};a.prototype.createPropertyFromArray=function(a){return this.createProperty(a)};a.prototype.renderLabel=function(a){return this.renderVariables(a,!1,!0)};return a}(e.PropertyType);b.BarDataPropertyType=f})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(c.Extensions||(c.Extensions={}))})(ProStyle||(ProStyle={}));
(function(c){(function(b){(function(b){(function(b){var e=function(b){function d(a,d,e,c,g,n,l,h,k,m,r){b.call(this,a,"simpleBarChart","SimpleBarChart",[h,m],[k,r]);this.bars=d;this.width=e;this.height=c;this.margin=g;this.minDomainValue=n;this.maxDomainValue=l;this.barsInit=m;this.barsScriptSet=r}__extends(d,b);return d}(c.Models.Items.Item);b.Extension=e})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(c.Extensions||(c.Extensions={}))})(ProStyle||(ProStyle={}));
(function(c){(function(b){(function(b){(function(b){var e=c.Models.Properties,f=function(){function d(){}d.cacheProperties=function(){d._propertyTypes=[];d._barPropertyTypes=[];var a=d._propertyTypes;a.push(e.Cache.ANIMATION);a.push(e.Cache.CROP_SVG);a.push(e.Cache.OPACITY);a.push(e.Cache.POSITION);a.push(e.Cache.ROTATION);a.push(e.Cache.SCALE);a.push(e.Cache.SKEW);a=d._barPropertyTypes;a.push(e.Cache.ANIMATION);a.push(new e.SvgFillPropertyType("rgba(0,0,0,0.5)"));a.push(e.Cache.OPACITY);a.push(e.Cache.SKEW);
a.push(new b.BarDataPropertyType)};d.getPropertyTypes=function(){void 0===d._propertyTypes&&d.cacheProperties();return d._propertyTypes};d.getBarPropertyTypes=function(){void 0===d._barPropertyTypes&&d.cacheProperties();return d._barPropertyTypes};d._propertyTypes=void 0;d._barPropertyTypes=void 0;return d}();b.Props=f})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(c.Extensions||(c.Extensions={}))})(ProStyle||(ProStyle={}));
(function(c){(function(b){(function(b){(function(b){var e=c.Util,f=function(b){function a(a,c){b.call(this,a,c,e.createChildSvgElement(c.div,"svg",{"class":"prostyle"}));this.simpleBarChartItem=a;this.barDivs=[];this.rangeBase=this.domainBase=this.domain=this.minDomain=this.maxDomain=this.barWidth=this.margin=this.height=this.width=0;this.g=e.createChildSvgElement(this.element,"g");for(var f=0;f<a.bars;f++)this.barDivs.push(e.createChildSvgElement(this.g,"rect"));this.maxDomain=a.maxDomainValue;this.minDomain=
a.minDomainValue;this.domain=Math.abs(this.maxDomain-this.minDomain);this.domainBase=0>this.maxDomain?this.maxDomain:0<this.minDomain?this.minDomain:0}__extends(a,b);a.prototype.initializeItem=function(a,b){var d=this.simpleBarChartItem,c=d.itemSet.flow.story,e=b.getContainedSize(d.itemSet.flow.pageAspectRatio);this.width=d.width/100*e.width;this.height=d.height/100*e.height;this.margin=this.simpleBarChartItem.margin/100*this.width;this.margin*(this.simpleBarChartItem.bars+1)>this.width?this.margin=
this.width/(this.simpleBarChartItem.bars+1):this.barWidth=(this.width-this.margin*this.simpleBarChartItem.bars)/this.simpleBarChartItem.bars;this.rangeBase=Math.abs(this.simpleBarChartItem.maxDomainValue-this.domainBase)/this.domain*this.height;var f={width:this.width,height:this.height};this.initializeProperties(c,[this.element],e,a,d.init,!0,f);f={};this.initializeProperties(c,this.barDivs,e,a,d.barsInit,!1,f,this.afterBarCssProperties.bind(this))};a.prototype.generateStepActions=function(a,b,d,
e,c){var f=this.simpleBarChartItem;this.generateActionsForStep(a,[this.element],b,d,e,c,f.scriptSet);this.generateActionsForStep(a,this.barDivs,b,d,e,c,f.barsScriptSet,this.afterBarCssProperties.bind(this))};a.prototype.afterBarCssProperties=function(a,b,d){var c=this;0>=this.domain||b.forEach(function(a,b){var d=e.convertToNumber(a.element.proCache.data[0],c.domainBase),f=e.convertToNumber(a.element.proCache.data[1],c.domainBase),k=(c.maxDomain-Math.max(d,f))/c.domain*c.height,d=(c.maxDomain-Math.min(d,
f))/c.domain*c.height-k,f=c.barWidth/8;a.attr={x:c.margin/2+b*(c.margin+c.barWidth),width:c.barWidth,y:k,height:d,rx:f,ry:f}})};return a}(c.Render.Items.Item);b.Renderer=f})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(c.Extensions||(c.Extensions={}))})(ProStyle||(ProStyle={}));
(function(c){(function(b){(function(b){(function(b){var e=c.Serialization,f=c.Util;b.readJson=function(d,a){var c=Math.max(1,Math.min(f.convertToNumber(f.getSetup(a,"bars")),100)),m=Math.max(0,f.convertToNumber(f.getSetup(a,"width"),50)),u=Math.max(0,f.convertToNumber(f.getSetup(a,"height"),50)),g=Math.max(0,f.convertToNumber(f.getSetup(a,"margin"),1)),n=0,l=0,h=f.getSetup(a,"domain");"number"===typeof h?l=h:h instanceof Array&&(n=0<h.length?f.convertToNumber(h[0]):0,l=1<h.length?f.convertToNumber(h[1]):
0);l<n&&(h=l,l=n,n=h);var p=b.Props.getPropertyTypes(),q=b.Props.getBarPropertyTypes(),h=e.PropertyListReader.read(d.story,a.init,p),r=e.PropertyListReader.read(d.story,a.barInit||a.barsInit,q),p=e.ScriptSetReader.readJson(d,"Chart",a,[""],p),q=e.ScriptSetReader.readJson(d,"Bars",a,["bar","bars"],q);return new b.Extension(d,c,m,u,g,n,l,h,p,r,q)}})(b.simpleBarChart||(b.simpleBarChart={}))})(b.Items||(b.Items={}))})(c.Extensions||(c.Extensions={}))})(ProStyle||(ProStyle={}));
